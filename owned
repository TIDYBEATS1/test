<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Owned Amiibos - Amiibo Tracker</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <nav id="navbar">
    <a href="index.html">Home</a>
    <a href="all.html">All Amiibos</a>
    <a href="categories.html">Categories</a>
    <a href="owned.html">Owned</a>
    <span id="userLinks"><a href="login.html">Login</a></span>
  </nav>

  <main>
    <h1>Your Owned Amiibos</h1>
    <div id="ownedList"></div>
  </main>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="js/firebase-init.js"></script>
  <script src="js/nav.js"></script>

  <script>
    firebase.auth().onAuthStateChanged((user) => {
      if (!user) {
        alert("Please login to see your owned Amiibos.");
        window.location.href = "login.html";
        return;
      }
      const db = firebase.firestore();
      const uid = user.uid;
      const ownedList = document.getElementById("ownedList");

      db.collection("users")
        .doc(uid)
        .collection("ownedAmiibos")
        .get()
        .then((snapshot) => {
          if (snapshot.empty) {
            ownedList.innerHTML = "<p>You do not own any Amiibos yet.</p>";
            return;
          }
          snapshot.forEach((doc) => {
            const amiibo = doc.data();
            const div = document.createElement("div");
            div.className = "card";
            div.innerHTML = `
              <img src="${amiibo.image}" alt="${amiibo.name}" style="max-width:100px;" />
              <h3>${amiibo.name}</h3>
              <p>${amiibo.amiiboSeries}</p>
            `;
            ownedList.appendChild(div);
          });
        });
    });
  </script>
</body>
</html>
